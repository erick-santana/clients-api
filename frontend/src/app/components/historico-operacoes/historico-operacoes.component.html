<div class="historico-container">
  <!-- Header -->
  <div class="header">
    <h2 mat-dialog-title>
      <mat-icon>history</mat-icon>
      Histórico de Operações
    </h2>
    <div class="cliente-info">
      <strong>{{ clienteNome }}</strong>
    </div>
    <button mat-icon-button (click)="fechar()" class="close-button">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <!-- Loading -->
  <div *ngIf="loading$ | async" class="loading-container">
    <mat-spinner diameter="40"></mat-spinner>
    <p>Carregando histórico...</p>
  </div>

  <!-- Conteúdo -->
  <div *ngIf="!(loading$ | async)" class="content">
    <!-- Lista de operações -->
    <div class="operacoes-list" *ngIf="operacoes.length > 0">
      <div class="operacao-item" *ngFor="let operacao of operacoes">
        <div class="operacao-header">
          <div class="tipo-operacao">
            <mat-icon [class]="getTipoClass(operacao.tipo)">
              {{ operacao.tipo === 'deposito' ? 'add_circle' : 'remove_circle' }}
            </mat-icon>
            <span class="tipo-text">{{ getTipoOperacao(operacao.tipo) }}</span>
          </div>
          <div class="status-operacao">
            <span class="status-badge" [class]="getStatusClass(operacao.status)">
              {{ getStatusOperacao(operacao.status) }}
            </span>
          </div>
        </div>

        <div class="operacao-details">
          <div class="valor-operacao">
            <strong>{{ formatCurrency(operacao.valor) }}</strong>
          </div>
          
          <div class="saldo-info">
            <div class="saldo-item">
              <span class="label">Saldo anterior:</span>
              <span class="valor">{{ formatCurrency(operacao.saldo_anterior) }}</span>
            </div>
            <div class="saldo-item">
              <span class="label">Saldo posterior:</span>
              <span class="valor">{{ formatCurrency(operacao.saldo_posterior) }}</span>
            </div>
          </div>

          <div class="data-operacao">
            <mat-icon>schedule</mat-icon>
            <span>{{ formatDate(operacao.created_at) }}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Mensagem quando não há operações -->
    <div class="no-operations" *ngIf="operacoes.length === 0">
      <mat-icon>info</mat-icon>
      <p>Nenhuma operação encontrada para este cliente.</p>
    </div>

    <!-- Paginação -->
    <div class="pagination-container" *ngIf="pagination && pagination.totalPages > 1">
      <mat-paginator
        [length]="pagination.total"
        [pageSize]="pageSize"
        [pageIndex]="currentPage - 1"
        [pageSizeOptions]="[10, 20, 50]"
        (page)="onPageChange($event.pageIndex + 1)">
      </mat-paginator>
    </div>
  </div>

  <!-- Footer -->
  <div class="footer">
    <button mat-button (click)="fechar()">
      Fechar
    </button>
  </div>
</div>
